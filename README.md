# Django REST framework Proxy

Сервис является прокси-сервером между приложениями на Django Core и FastAPI.
Служит также для сбора и обработки логов и метрик с использованием Grafana/Prometheus/Loki.

## Особенности
- Передача запросов, поступивших из Django Core в FastAPI.
- Сохранение пользователей прошедших регистрацию в Django Core.
- Хранение данных пользователей в базе данных sqLite.
- Выдача JWT токенов аутентифицированным пользователям.
- Сбор метрик о пользователе и запросе который он направил посредством middleware.
- Логирование состояния запросов их структуры и успешности выполнения.
- Контейнеризация с использованием Docker и docker-compose.

## Требования
- Python 3.12
- Docker

## Установка

1. Клонируйте репозиторий:
        git clone """ЗДЕСЬ БУДЕТ ССЫЛКА НА МОЙ GITHUB, ЕЩЕ НЕ ЗАЛИВАЛ"""


2. Настройка Docker:
    Убедитесь, что у вас установлен Docker и Docker Compose. Если нет, установите их с официальных сайтов.


3. Запустите контейнеры с помощью Docker Compose:
        docker-compose up --build


    Это запустит:
    - общий network для взаимодействия приложения с Django Core и FastApi.
    - Django приложение (порт 8002).
    - Loki для сбора логов (порт 3100).
    - Prometheus для сбора и обработки метрик (9090).
    - Grafana для формирования дашбордов и обработки полученных логов и метрик (порт 3000).

4. Приложение будет доступно по адресу:
    
    http://0.0.0.0:8002/
    
    Prometheus: http://localhost:9090
    Grafana: http://localhost:3000
    Loki: http://loki:3100


5. Тестирование приложения.
    Для запуска тестов приложения введите следующую команду в консоли:
        docker exec -it <№контейнера>  python manage.py test

   
## Структура проекта

```plaintext
.
├── drf_proxy/
│   ├── __init__.py
│   ├── asgi.py               # Настройка для работы с асинхронностью
│   ├── logging_handler.py    # Handler сбора логов для Loki
│   ├── middleware.py         # Middleware сбора метрик для Prometheus
│   ├── settiings.py          # Настройки приложения
│   ├── urls.py               # Используемые приложением url
│   └── wsgi.py               
├── jwt_manager/  
│   ├── migrations/           # Директория миграций
│   ├── __init__.py
│   ├── admin.py              # Настройка панели администратора
│   ├── apps.py               # Настройка приложения
│   ├── models.py             # Модели таблиц БД
│   ├── tests.py              # Тестирование приложения
│   ├── urls.py               # URI используемые приложением
│   ├── views.py              # Представления для выполнения логики приложения
├── .env                      # Файл с переменными окружения
├── create_superuser.py       # Скрипт создания администратора при запуске приложения
├── db_sqlite3                # База данных sqLite
├── docker-compose.yml        # Docker Compose файл
├── Dockerfile                # Dockerfile для приложения
├── manage.py                 # Входная точка приложения
├── prometheus.yml            # Конфигурация prometheus (период опроса, таргеты опроса)
├── README.md                 # Документация и описание приложения
└── requirements.txt          # Список зависимостей